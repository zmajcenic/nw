10 ' CONSOLE TEST IN SCREEN 2
20 KEYOFF:COLOR 15,1,1:SCREEN 2,2:VDP(7)=(VDP(7) AND &HFC) OR 4
30 DEFINT A-Z

100 ' FAKE SCREEN 1 MODE, SET WIDTH 30, 6 LINES SCREEN HEIGHT AND NAME TABLE BEGIN
110 POKE &HFCAF,1:' SCREEN MODE
120 POKE &HF3AF,30:' LINL32
130 POKE &HF3B0,30:' LINLEN
140 POKE &HF3B1,6:' CRTCNT
150 Y=BASE(10)+512+2*32:' SCREEN 2 NAME TABLE BOTTOM THIRD PLUS 2 ROWS
160 POKE &HF922,Y MOD 256
170 POKE &HF3BD,Y MOD 256
180 POKE &HF923,Y\256
190 POKE &HF9BE,Y\256
200 CLS:Y=BASE(10)+512:FOR I=0 TO 63:VPOKE Y+I,32:NEXT
210 ' DO FIXES REGARDING CURSOR
220 'VPOKE BASE(10)+255,254:VPOKE BASE(10)+511,254:' HIDE 255 CHARS
230 ' FILL PATTERN OF CURSOR CHARACTER
240 'VPOKE BASE(12)+6143,255
250 PRINT "WAIT ...."

300 ' COPY CHARACTER SET FROM ROM TO LOWER SCREEN THIRD AND SET COLOR
310 X=256*PEEK(5)+PEEK(4)+32*8:' FONT FROM CHARACTER 32
320 Y=BASE(12)+4096+32*8:Z=BASE(11)+4096+32*8
330 FOR I=0 TO 767:VPOKE Y+I,PEEK (X+I):VPOKE Z+I,&H1F:NEXT

400 ' DEFINE CHARACTER 0 - LEFT GRID
410 Y=BASE(12)+4096:RESTORE 50370
420 FOR I=0 TO 7:READ A: VPOKE Y+I,A:NEXT
430 ' DEFINE CHARACTER 31 - RIGHT GRID
440 Y=BASE(12)+4096+31*8
450 FOR I=0 TO 7:READ A: VPOKE Y+I,A:NEXT
460 ' DRAW GRID
470 Y=BASE(10)+512
480 FOR I=0 TO 7:VPOKE Y+I*32,0:VPOKE Y+I*32+31,31:NEXT
490 ' COLOR GRID
500 Z=BASE(11)+4096
510 FOR I=0 TO 7:VPOKE Z+I,&H1E:VPOKE Z+I+248,&H1E:NEXT

700 ' DEFINE ACTION BUTTONS
710 RESTORE 50020
720 BN=5:K=255-4*BN:Y=BASE(12)+4096+8*K:Z=BASE(11)+4096+8*K
730 FOR I=0 TO BN*32-1:READ A:VPOKE Y+I,A:VPOKE Z+I,&H1E:NEXT
740 ' DEFINE CHARACTER 1&2 - UPPER AND LOWER SEPARATORS
750 Y=BASE(12)+4096+8:Z=BASE(11)+4096+8:RESTORE 51010
760 FOR I=0 TO 15:READ A: VPOKE Y+I,A:VPOKE Z+I,&H1E:NEXT
770 Y=BASE(10)+513
780 FOR L=0 TO BN-1:FOR J=0 TO 1:FOR I=0 TO 1
790 VPOKE Y+J+I*32,K:K=K+1
800 NEXT I:NEXT J
810 VPOKE Y+2,1:VPOKE Y+34,2:Y=Y+3:NEXT L

900 POKE &HFCAF,2:' SCREEN MODE
910 LINE (0,0)-(255,127),4,BF
920 GOSUB 40000:'ISLANDS

940 'CITY SPRITES
950 I=0:RESTORE 50500:GOSUB 53000
960 PUT SPRITE 0,(57,27),1,0:PUT SPRITE 31,(57,27),7,1
970 PUT SPRITE 1,(20,15),1,2:PUT SPRITE 30,(20,15),15,3
980 PUT SPRITE 2,(90,3),1,4:PUT SPRITE 29,(90,3),15,5
990 PUT SPRITE 3,(168,68),1,0:PUT SPRITE 28,(168,68),7,1
1000 PUT SPRITE 4,(97,56),1,2:PUT SPRITE 27,(97,56),15,3
1010 PUT SPRITE 5,(200,44),1,4:PUT SPRITE 26,(200,44),15,5
1020 PUT SPRITE 6,(57,99),1,0:PUT SPRITE 25,(57,99),7,1
1030 PUT SPRITE 7,(20,87),1,2:PUT SPRITE 24,(20,87),15,3
1040 PUT SPRITE 8,(90,75),1,4:PUT SPRITE 23,(90,75),15,5
 

5000 GOSUB 52000
5010 VPOKE BASE(11)+1,&HF4:VPOKE BASE(11)+2049,&HF4
5020 ON INTERVAL=100 GOSUB 41000
5030 INTERVAL ON

10000 'MAIN LOOP
10010 POKE &HFCAF,1:' SCREEN MODE
10020 PRINT "command: ";
10030 A$=INKEY$:IF A$="" GOTO 10030
10040 PRINT A$
10050 GOTO 10020

40000 ' DRAW TOP ISLAND
40010 PRESET (15,12)
40020 DRAW "C10 R15U1R4U2R23U1R55D1R8D2R7D1R10D2R17U1R6D1R3D1R3D3L1D2L2D1L19D2L7D1L3D2L1D1L5D1L3D1L1D1L1D1L2D2L1D1L2D1L3D2L16D1L3D1L1D1L5D1L49D1L12U1L3U1L3U2L14U3L2U1L1U3L2U5L1U3R2U2R1U2R2U1R1U2R2U1R4U2"
40030 PAINT (16,13),10,10
40040 PRESET (9,38)
40050 DRAW "C6 R14D2R2BD1BR4BD1R12BU1BR1R48BU1BR1R4BU1BR1U1R3BU1BR1R15BR4BU3R1U1R1BR5BU5R2U1R5BR2BU2R2BU1BR1R6U2R19"
40060 ' DRAW MIDDLE ISLAND
40070 PRESET (76,69)
40080 DRAW "C10 R2U4R3U1R1U1R4U1R7U1R1U1R3U1R3U1R1U1R1U1R15U1R3U1R1U1R5U1R5U1R1U1R5U1R82D1R1D2R2D1R6D2R17D1R3D1R1D2R2D1R1D3R3D5L1D4L2D2L1D1L4D1L19U1L22D2L5D1L6D1L1D1L7D1L21U2L6U1L1U1L15D1L3D1L1D2L13U1L1U1L16U1L11U2L4U1L11U1L5U2L3U1L1U1L1"
40090 PAINT (82,67),10,10
40100 PRESET (79,74)
40110 DRAW "C6 R4BR1BD1R10BR1BD1R3BR1BD2R10BR1BD1R15BR1BD1R1D1R13BR20BU2R5BR1BD2R21BR1BU1R6BR2BU2R5U1R5BR1BU2R21D1R19BR1BU1R3"
40120 ' DRAW BOTTOM ISLAND
40130 PRESET (7,95)
40140 DRAW "C10 R9U1R6U1R4U1R4U1R4U2R8U1R8D1R28D1R15U1R6F2R13F2R4F1R9F1R6F1R9D3R1F1D2R1G1L2D7G1L5D1L7D1L2D1L5D1L9U1L4U2L7D1L2D1L3D1G1D1L2D1L2D1L3D1L2D1L5D1L16U1L5U1L8U1L18U1L4U1L2U1L20G1L8H2U4E1U1E1R2U1E1U3L1U2L1U2L1U1E1U1"
40150 PAINT (9,97),10,10
40160 PRESET (5,117)
40170 DRAW "C6 R8E1R19BR3BD2R3F1R17F1R7F1R5D1R16E1R4BR4BU2R1BR7BU5R1BR3BU2R5BR5BD3R9E1R4BR3BU2R6E1R4"
40990 RETURN

41000 R=INT(RND(1)*256):VPOKE BASE(12)+1,R:VPOKE BASE(12)+2049,R
41990 RETURN

50000 ' --- factory
50010 ' color 1
50020 DATA &HFF,&H00,&H30,&H30,&H31,&H33,&H3F,&H3F
50030 DATA &H32,&H35,&H37,&H37,&H3F,&H00,&HFF,&H00
50040 DATA &HFF,&H00,&H00,&H00,&H24,&H6C,&HFC,&HFC
50050 DATA &H7C,&H7C,&H7C,&H7C,&HFC,&H00,&HFF,&H00
50060 ' 
50070 ' --- rocket
50080 ' color 1
50090 DATA &HFF,&H00,&H00,&H00,&H00,&H01,&H03,&H07
50100 DATA &H1F,&H27,&H0A,&H12,&H04,&H00,&HFF,&H00
50110 DATA &HFF,&H00,&H00,&H70,&HF0,&HB0,&H60,&HC0
50120 DATA &H80,&H1C,&H14,&H1C,&H14,&H00,&HFF,&H00
50130 ' 
50140 ' --- satellite
50150 ' color 1
50160 DATA &HFF,&H00,&H00,&H00,&H00,&H00,&H00,&H01
50170 DATA &H05,&H0E,&H1B,&H36,&H1C,&H08,&HFF,&H00
50180 DATA &HFF,&H00,&H10,&H38,&H6C,&HD8,&H70,&HA0
50190 DATA &H80,&H0C,&H0A,&H0A,&H0C,&H00,&HFF,&H00
50200 ' 
50210 ' --- propaganda
50220 ' color 1
50230 DATA &HFF,&H09,&H25,&H10,&H09,&H43,&H37,&H03
50240 DATA &H31,&H45,&H09,&H11,&H03,&H03,&HFF,&H00
50250 DATA &HFF,&H20,&H48,&H10,&H20,&H84,&HD8,&H80
50260 DATA &H10,&H46,&H25,&H06,&H84,&H80,&HFF,&H00
50270 ' 
50280 ' --- Launch
50290 ' color 1
50300 DATA &HFF,&H00,&H07,&H08,&H13,&H27,&H2F,&H2F
50310 DATA &H2F,&H27,&H13,&H08,&H07,&H00,&HFF,&H00
50320 DATA &HFF,&H00,&HC0,&H20,&H90,&HC8,&HE8,&HE8
50330 DATA &HE8,&HC8,&H94,&H24,&HC6,&H00,&HFF,&H00
50340 ' 
50350 ' --- grid
50360 ' color 1
50370 DATA &HFE,&H82,&HA2,&H82,&H82,&H82,&H8A,&H82
50380 DATA &H7F,&H41,&H51,&H41,&H41,&H41,&H45,&H41

50500 'city sprites
50510 ' --- city large
50520 ' color 1
50530 DATA &HFC,&HFC,&HB5,&HFD,&HAD,&HFD,&HB5,&HFD
50540 DATA &HD5,&HFD,&HFD,&HFD,&H00,&H00,&H00,&H00
50550 DATA &H0F,&H0B,&HEF,&HEB,&H6D,&HEF,&HAB,&HEF
50560 DATA &HED,&HEF,&HEF,&HEF,&H00,&H00,&H00,&H00
50570 ' color 7
50580 DATA &H00,&H00,&H48,&H00,&H50,&H00,&H48,&H00
50590 DATA &H28,&H00,&H00,&H00,&H00,&H00,&H00,&H00
50600 DATA &H00,&H04,&H00,&H04,&H82,&H00,&H44,&H00
50610 DATA &H02,&H00,&H00,&H00,&H00,&H00,&H00,&H00
50620 ' --- city medium
50630 ' color 1
50640 DATA &H00,&H01,&H02,&H07,&H03,&H12,&H3A,&H54
50650 DATA &HFE,&H7C,&H4C,&H4C,&H00,&H00,&H00,&H00
50660 DATA &H80,&HC0,&HA0,&HF0,&HE0,&H68,&H5C,&H3E
50670 DATA &H6B,&H3E,&H26,&H26,&H00,&H00,&H00,&H00
50680 ' color 15
50690 DATA &H00,&H00,&H01,&H00,&H00,&H01,&H01,&H28
50700 DATA &H00,&H00,&H30,&H30,&H00,&H00,&H00,&H00
50710 DATA &H00,&H00,&H40,&H00,&H00,&H80,&H80,&H00
50720 DATA &H14,&H00,&H18,&H18,&H00,&H00,&H00,&H00
50730 ' --- city small
50740 ' color 1
50750 DATA &H00,&H00,&H00,&H10,&H38,&H6C,&HC6,&H00
50760 DATA &H09,&H1C,&H36,&H63,&H00,&H00,&H00,&H00
50770 DATA &H08,&H1C,&H36,&H63,&H00,&H20,&H70,&HD8
50780 DATA &H8C,&H00,&H00,&H00,&H00,&H00,&H00,&H00
50790 ' color 15
50800 DATA &H00,&H00,&H00,&H00,&H00,&H10,&H38,&H00
50810 DATA &H00,&H00,&H08,&H1C,&H00,&H00,&H00,&H00
50820 DATA &H00,&H00,&H08,&H1C,&H00,&H00,&H00,&H20
50830 DATA &H70,&H00,&H00,&H00,&H00,&H00,&H00,&H00
50840 ' --- city rubble
50850 ' color 1
50860 DATA &H00,&H00,&H00,&H00,&H00,&H01,&H3E,&H69
50870 DATA &H32,&H1F,&H00,&H00,&H00,&H00,&H00,&H00
50880 DATA &H00,&H00,&H00,&H00,&H00,&HE0,&HDC,&H2B
50890 DATA &HFE,&H80,&H00,&H00,&H00,&H00,&H00,&H00
50900 ' color 9
50910 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H06
50920 DATA &H0D,&H00,&H00,&H00,&H00,&H00,&H00,&H00
50930 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&HD4
50940 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
50950 DATA *

51000 ' separator
51010 DATA &HFF,&H10,&H10,&H10,&H10,&H10,&H10,&H10
51020 DATA &H10,&H10,&H10,&H10,&H10,&H10,&HFF,0

52000 ' SEA TILES
52010 RESTORE 52100
52020 X=BASE(10)
52030 READ A:IF A=-1 THEN RETURN
52040 VPOKE X+A,0
52050 GOTO 52030
52100 DATA 8,17,26,62,88,115,122,144,150,156,161,175,184,196,204,226,231,263,290,296,325,334,339,348,373,381,407,411,435,440,447,469,477,493,500,507,-1

53000 'LOAD SPRITE DEFINITIONS, I=BEGIN SPRITE
53010 S=BASE(9)+I*32
53020 READ R$: IF R$="*" THEN RETURN ELSE VPOKE S,VAL(R$):S=S+1:GOTO 53020
